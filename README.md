# jikken3

## 走行モードの選択

`leader/leader.ino` では、往復走行・周回走行・端点Uターン走行を切り替えられる `RunMode` を用意しています。

1. **コンパイル時既定値**: `COMPILE_TIME_RUNMODE` を `RUNMODE_RECIP`（往復）、`RUNMODE_UTURN`（端点でその場Uターン）、`RUNMODE_LOOP`（周回）から選択します。
2. **可変抵抗スイッチ**: `leader/run_mode_pot.ino` のロジックにより、`RUNMODE_POT_PIN`（既定で A2）へ接続した可変抵抗の位置で起動時にモードを選択できます。しきい値は 3 分割されており、低域で往復、中域で端点 U ターン、高域で周回モードになります。

起動時には選択されたモードがシリアルログに表示されるため、オペレータは現在の走行方針を確認できます。

## センサ優勢時の挙動について

ライン追従では、右センサがより黒を検出したとき `computeError` が正となり、前進時は左車輪が速く・右車輪が遅くなる補正をかけて機体が右へ寄るよう制御しています。一方で後退やリカバリーでは左右の符号が反転するため、左車輪の後退量が大きく（角速度は左旋回）なりながらも、機体は後退軌道で右へ弧を描いてラインへ復帰します。センサ優勢と旋回方向の直感が一致しなくても、最終的な軌道は右センサ優勢なら右へ、左センサ優勢なら左へ寄る設計になっています。
